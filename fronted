<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>تبدیل گفتار به متن فارسی</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h1>تبدیل گفتار به متن فارسی</h1>
    <button id="recordBtn">ضبط صدا</button>
    <textarea id="output" placeholder="متن تبدیل شده اینجا نمایش داده می‌شود..."></textarea>
    <button id="saveBtn" style="display:none;">ذخیره ویرایش</button>
  </div>
const recordBtn = document.getElementById('recordBtn');
const output = document.getElementById('output');
const saveBtn = document.getElementById('saveBtn');
let isRecording = false;
let audioChunks = [];

recordBtn.onclick = () => {
  if (!isRecording) {
    navigator.mediaDevices.getUserMedia({ audio: true })
      .then(stream => {
        const mediaRecorder = new MediaRecorder(stream);
        mediaRecorder.start();
        isRecording = true;
        recordBtn.textContent = "در حال ضبط...";

        mediaRecorder.ondataavailable = e => {
          audioChunks.push(e.data);
        };

        mediaRecorder.onstop = () => {
          const audioBlob = new Blob(audioChunks, { type: 'audio/wav' });
          const formData = new FormData();
          formData.append('audio', audioBlob);

          fetch('/transcribe', {
            method: 'POST',
            body: formData
          })
          .then(res => res.json())
          .then(data => {
            output.value = data.text;
            saveBtn.style.display = 'block';
          });

          audioChunks = [];
        };

        recordBtn.onclick = () => {
          mediaRecorder.stop();
          stream.getTracks().forEach(track => track.stop());
          recordBtn.textContent = "ضبط صدا";
          isRecording = false;
          recordBtn.onclick = () => {
            // بازگشت به حالت ضبط
          };
        };
      });
  }
};

saveBtn.onclick = () => {
  fetch('/save-correction', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      original: output.defaultValue || '',
      corrected: output.value
    })
  });
  alert("ویرایش ذخیره شد.");
};

  <script src="script.js"></script>
</body>
</html>
body {
  font-family: Tahoma, sans-serif;
  direction: rtl;
  text-align: right;
}

.container {
  max-width: 600px;
  margin: 0 auto;
  padding: 20px;
}

#output {
  width: 100%;
  height: 150px;
  margin-top: 10px;
}
